{"version":3,"sources":["../src/domain.js"],"names":["loadDomainDefinitions","getWireFormat","domainClasses","wireFormat","DOMAIN_REGEX","ctx","keys","i","length","moduleName","m","exec","default","console","log","WireFormat","config","inputSchema"],"mappings":";;;;;QASgBA,qB,GAAAA,qB;QAyBAC,a,GAAAA,a;;AAlChB;;AACA;;;;;;AAEA,IAAMC,gBAAgB,EAAtB;;AAEA,IAAIC,mBAAJ;;AAEA,IAAMC,eAAe,yBAArB;;AAEO,SAASJ,qBAAT,CAA+BK,GAA/B,EACP;AACI,QAAMC,OAAOD,IAAIC,IAAJ,EAAb;;AAEA;;AAEA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAID,KAAKE,MAAzB,EAAiCD,GAAjC,EACA;AACI,YAAME,aAAaH,KAAKC,CAAL,CAAnB;;AAEA,YAAMG,IAAIN,aAAaO,IAAb,CAAkBF,UAAlB,CAAV;AACA,YAAIC,CAAJ,EACA;AACIR,0BAAcQ,EAAE,CAAF,CAAd,IAAsBL,IAAII,UAAJ,EAAgBG,OAAtC;AACH;AACJ;;AAEDC,YAAQC,GAAR,CAAY,gBAAZ,EAA8BZ,aAA9B;;AAEAC,iBAAa,IAAIY,wBAAJ,CACTC,iBAAOC,WADE,EAETf,aAFS,CAAb;AAIH;;AAEM,SAASD,aAAT,GACP;AACI,WAAOE,UAAP;AACH","file":"domain.js","sourcesContent":["import { WireFormat } from \"domainql-form\"\nimport config from \"./config\"\n\nconst domainClasses = {};\n\nlet wireFormat;\n\nconst DOMAIN_REGEX = /^\\.\\/domain\\/(.*?)\\.js$/\n\nexport function loadDomainDefinitions(ctx)\n{\n    const keys = ctx.keys();\n\n    //console.log(\"Modules: \", keys);\n\n    for (let i = 0; i < keys.length; i++)\n    {\n        const moduleName = keys[i];\n\n        const m = DOMAIN_REGEX.exec(moduleName);\n        if (m)\n        {\n            domainClasses[m[1]] = ctx(moduleName).default;\n        }\n    }\n\n    console.log(\"DOMAIN-CLASSES\", domainClasses);\n\n    wireFormat = new WireFormat(\n        config.inputSchema,\n        domainClasses\n    );\n}\n\nexport function getWireFormat()\n{\n    return wireFormat;\n}\n"]}